# 分散分析  

### 用語

- 要因  
データに変化を与える要素  
e.g. 組，気温，時刻

- 因子  
母平均の差に影響しそうであるとして注目する要因

- 水準  
1つの要因に含まれる項目  
e.g. 組の水準は「1組,2組,3組」の3つ

- n元配置  
データに含まれる因子数  
e.g. 1~3組のテストの点数は一元配置データ

---

## 一元配置分散分析
3群以上からなるデータ(e.g. 1~3組)について母平均の差を検定する．

その過程で，次の表を埋めていく．
|因子|平方和|自由度|平均平方|F値|
|-|-|-|-|-|
要因|
残差|
全体|

e.g. 都道府県内にある映画館の数を地方ごとに分けた表から，地方によって映画館の数の母平均に差があるかを検定する．
```tsv
北海道	21	12	8	11	6	3	4		
関東	92	15	6	5	5	5	5		
中部	2	18	5	5	21	6	0	2	14
近畿	8	20	11	34	4	0	10		
中国	8	13	5	0	1				
四国	2	3	3	1					
九州	13	2	2	5	5	9	4	7	
```
$H_0$ : 各地方の映画館数の母平均は等しい

### 手順1: 平方和を求める．

1. データ全体の平均と各群の平均値の算出  
```tsv
北海道	9.29
関東	19.00
中部	8.11
近畿	12.43
中国	5.40
四国	2.52
九州	5.88

全体    9.38
```

2. データ全体の平均値と各データの差を合計する．  
$\sum_i (x_i -\bar{x})^2 = (21-9.38)^2 + (12-9.38)^2 + \cdots+(7-9.38)^2 = 9085.11$
3. データ全体の平均値からの因子の各水準の平均値の差を合計する．  
$\sum_i n_i(\bar{x}_i-\bar{x})^2 = 7(9.29-9.38)^2 + \cdots + 8(5.88-9.38)^2 = 1108.25$
4. 全体の平均値からの各データのズレ$-$全体の平均値からの因子の各水準の平均値のズレを求める．  
すなわち，2.と3.の結果を足し合わせる．  
$9085.11-1108.25=7976.86$

###  自由度を求める．
1. 全体の自由度を求める．$47-1=46$
2. 要因の自由度を求める．$7-1=6$
3. 残差の自由度を求める．$41-1=40$

### 平均平方を求める．
各因子において，平均平方 $=$ 平方和 / 自由度で求められる．

### 統計量Fを求め，片側検定する．
$F=\frac{s^2_1}{s^2_2} = 184.71/199.42 = 0.926$  
$F_{5\%,upper}($要因,残差$) = F_{5\%, upper}(6,40) = 2.336$  
検定統計量は棄却域に入っていないので，$H_0$を採択する．  
<u> 地方によって映画館の数の母平均に差があるとはいえない </u>

---

## 二元配置分散分析  
1つのデータに複数の要素を含むデータ(e.g. 薬A~Cをそれぞれ10mg,20mg投与)について母平均の差を検定する．

